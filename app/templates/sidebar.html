<!-- Sidebar -->
<div
  id="application-sidebar"
  class="fixed top-0 start-0 bottom-0 z-[60] w-64 bg-white border-e border-gray-200 pt-7 pb-10 overflow-y-auto transition-all duration-300 transform -translate-x-full lg:translate-x-0 lg:block [&::-webkit-scrollbar]:w-2 [&::-webkit-scrollbar-thumb]:rounded-full [&::-webkit-scrollbar-track]:bg-gray-100 [&::-webkit-scrollbar-thumb]:bg-gray-300 dark:[&::-webkit-scrollbar-track]:bg-slate-700 dark:[&::-webkit-scrollbar-thumb]:bg-slate-500 dark:bg-gray-800 dark:border-gray-700"
>
  <div class="px-6">
    <button
      id="menu-button-close"
      data-collapse-toggle="navbar-hamburger"
      type="button"
      class="lg:hidden inline-flex items-center justify-center p-2 w-10 h-10 text-sm text-gray-500 rounded-lg hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600"
      aria-controls="navbar-hamburger"
      aria-expanded="false"
    >
      <span class="sr-only">Open main menu</span>
      <svg
        class="w-5 h-5"
        aria-hidden="true"
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        viewBox="0 0 17 14"
      >
        <path
          stroke="currentColor"
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M1 1h15M1 7h15M1 13h15"
        />
      </svg>
    </button>
    <a
      onclick="window.location.href = '/' ; "
      class="flex-none text-xl font-semibold dark:text-white dark:focus:outline-none dark:focus:ring-1 dark:focus:ring-gray-600"
      href="#"
      aria-label="Brand"
      >ARUP</a
    >
  </div>

  <nav
    class="hs-accordion-group p-6 w-full flex flex-col flex-wrap"
    data-hs-accordion-always-open
  >
    <ul class="space-y-2">
      <li>
        <a
          href="/"
          class="w-full flex items-center gap-x-3.5 py-2 px-2.5 text-sm text-slate-700 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-900 dark:text-slate-400 dark:hover:text-slate-300 dark:focus:outline-none dark:focus:ring-1 dark:focus:ring-gray-600 {{ 'bg-gray-100 dark:bg-gray-700' if request.path == '/' }}"
        >
          <svg
            class="flex-shrink-0 size-4"
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" />
            <polyline points="9 22 9 12 15 12 15 22" />
          </svg>
          Dashboard
        </a>
      </li>

      <nav>
        <ul>
          <li class="hs-accordion" id="users-accordion">
            <div
              class="cursor-pointer hs-accordion-toggle w-full text-start flex items-center gap-x-12 py-2 px-2.5 hs-accordion-active:text-blue-600 hs-accordion-active:hover:bg-transparent text-sm text-slate-700 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-900 dark:text-slate-400 dark:hover:text-slate-300 dark:hs-accordion-active:text-white dark:focus:outline-none dark:focus:ring-1 dark:focus:ring-gray-600 select-none mb-2"
              onclick="toggleDropdown('recent-location-dropdown'); return false;"
            >
              <a href="/" class="flex items-center gap-x-3.5">
                <svg
                  class="flex-shrink-0 size-4"
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path
                    stroke="currentColor"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M12 13a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"
                  />
                  <path
                    stroke="currentColor"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M17.8 14h0a7 7 0 1 0-11.5 0h0l.1.3.3.3L12 21l5.1-6.2.6-.7.1-.2Z"
                  />
                </svg>
                Recent Locations
              </a>
              <button>
                <svg
                  class="hs-accordion-active:block ms-auto hidden size-4"
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path d="m18 15-6-6-6 6" />
                </svg>

                <svg
                  class="hs-accordion-active:hidden ms-auto block size-4"
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path d="m6 9 6 6 6-6" />
                </svg>
              </button>
            </div>
            <div
              id="recent-location-dropdown"
              class="hs-accordion-content hidden"
            >
              <ul>
                {% for location in session.get('visited_locations', []) %}
                <li>
                  <a
                    href="/{{ location.id }}"
                    class="flex items-center gap-x-3.5 py-2 px-2.5 text-sm text-slate-700 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-900 dark:text-slate-400 dark:hover:text-slate-300 dark:focus:outline-none dark:focus:ring-1 dark:focus:ring-gray-600 mx-8 {{ 'bg-gray-100 dark:bg-gray-700' if request.path == '/' + location.id|string }}"
                  >
                    {{ location.name }}
                  </a>
                </li>
                {% endfor %}
              </ul>
            </div>
          </li>
        </ul>
      </nav>

      <nav>
        <ul>
          <li class="hs-accordion" id="users-accordion">
            <div
              class="cursor-pointer hs-accordion-toggle w-full text-start flex items-center gap-x-12 py-2 px-2.5 hs-accordion-active:text-blue-600 hs-accordion-active:hover:bg-transparent text-sm text-slate-700 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-900 dark:text-slate-400 dark:hover:text-slate-300 dark:hs-accordion-active:text-white dark:focus:outline-none dark:focus:ring-1 dark:focus:ring-gray-600 select-none mb-2"
              onclick="toggleDropdown('recent-runs-dropdown'); return false;"
            >
              <a class="flex items-center gap-x-3.5">
                <svg
                  class="flex-shrink-0 size-4"
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path
                    stroke="currentColor"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M12 13a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"
                  />
                  <path
                    stroke="currentColor"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M17.8 14h0a7 7 0 1 0-11.5 0h0l.1.3.3.3L12 21l5.1-6.2.6-.7.1-.2Z"
                  />
                </svg>
                Recent Runs
              </a>
              <button>
                <svg
                  class="hs-accordion-active:block ms-auto ml-5 hidden size-4"
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path d="m18 15-6-6-6 6" />
                </svg>

                <svg
                  class="hs-accordion-active:hidden ms-auto ml-5 block size-4"
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path d="m6 9 6 6 6-6" />
                </svg>
              </button>
            </div>
            <div id="recent-runs-dropdown" class="hs-accordion-content hidden">
              <ul>
                {% for run in session.get('recent_runs', [],) %}
                <li>
                  <a
                    href="/{{ run.location }}/{{ run.id }}"
                    class="flex items-center gap-x-3.5 py-2 px-2.5 text-sm text-slate-700 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-900 dark:text-slate-400 dark:hover:text-slate-300 dark:focus:outline-none dark:focus:ring-1 dark:focus:ring-gray-600 mx-8 {{ 'bg-gray-100 dark:bg-gray-700' if request.path == '/' + run.location|string + '/' +  run.id|string }}"
                  >
                    {{ run.name }}
                  </a>
                </li>
                {% endfor %}
              </ul>
            </div>
          </li>
        </ul>
      </nav>

      <nav>
        <ul>
          <li class="hs-accordion" id="users-accordion">
            <div
              class="hs-accordion-toggle w-full text-start flex items-center gap-x-12 py-2 px-2.5 hs-accordion-active:text-blue-600 hs-accordion-active:hover:bg-transparent text-sm text-slate-700 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-900 dark:text-slate-400 dark:hover:text-slate-300 dark:hs-accordion-active:text-white dark:focus:outline-none dark:focus:ring-1 dark:focus:ring-gray-600 mb-2 {{ 'bg-gray-100 dark:bg-gray-700' if request.path == '/docs' }}"
            >
              <a href="/docs" class="flex items-center gap-x-3.5">
                <svg
                  class="flex-shrink-0 size-4"
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z" />
                  <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z" />
                </svg>
                Documentation
              </a>
              <button
                onclick="toggleDropdown('documentation-dropdown'); return false;"
              >
                <svg
                  class="hs-accordion-active:hidden ms-auto block size-4"
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path d="m6 9 6 6 6-6" />
                </svg>
              </button>
            </div>
            <div
              id="documentation-dropdown"
              class="hs-accordion-content hidden"
            >
              <ul>
                <li>
                  <a
                    href="/docs/getting_started"
                    class="flex items-center gap-x-3.5 py-2 px-2.5 text-sm text-slate-700 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-900 dark:text-slate-400 dark:hover:text-slate-300 dark:focus:outline-none dark:focus:ring-1 dark:focus:ring-gray-600 mx-8 {{ 'bg-gray-100 dark:bg-gray-700' if request.path == '/docs/getting_started' }}"
                    >Getting Started</a
                  >
                </li>
                <li>
                  <a
                    href="/docs/faqs"
                    class="flex items-center gap-x-3.5 py-2 px-2.5 text-sm text-slate-700 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-900 dark:text-slate-400 dark:hover:text-slate-300 dark:focus:outline-none dark:focus:ring-1 dark:focus:ring-gray-600 mx-8 {{ 'bg-gray-100 dark:bg-gray-700' if request.path == '/docs/faqs' }}"
                    >FAQs</a
                  >
                </li>
                <li>
                  <a
                    href="/docs/test_1_dry_day"
                    class="flex items-center gap-x-3.5 py-2 px-2.5 text-sm text-slate-700 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-900 dark:text-slate-400 dark:hover:text-slate-300 dark:focus:outline-none dark:focus:ring-1 dark:focus:ring-gray-600 mx-8 {{ 'bg-gray-100 dark:bg-gray-700' if request.path == '/docs/test_1_dry_day' }}"
                    >Dry Day Discharges</a
                  >
                </li>
                <li>
                  <a
                    href="/docs/test_2_rainfall_discharge"
                    class="flex items-center gap-x-3.5 py-2 px-2.5 text-sm text-slate-700 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-900 dark:text-slate-400 dark:hover:text-slate-300 dark:focus:outline-none dark:focus:ring-1 dark:focus:ring-gray-600 mx-8 {{ 'bg-gray-100 dark:bg-gray-700' if request.path == '/docs/test_2_rainfall_discharge' }}"
                    >Moderate Rainfall Discharges</a
                  >
                </li>
               
              </ul>
            </div>
          </li>
        </ul>
      </nav>
      <script>
        function setDropdownState(dropdownId, isOpen) {
          localStorage.setItem(dropdownId, isOpen);
        }

        function getDropdownState(dropdownId) {
          return localStorage.getItem(dropdownId) === "true";
        }
        // Function to toggle the dropdown visibility
        function toggleDropdown(dropdownId) {
          var dropdown = document.getElementById(dropdownId);
          if (dropdown) {
            dropdown.classList.toggle("hidden");
            setDropdownState(
              dropdownId,
              !dropdown.classList.contains("hidden")
            );
          }
        }

        function initializeDropdownStates() {
          var dropdowns = document.querySelectorAll(".hs-accordion-content");
          dropdowns.forEach(function (dropdown) {
            var dropdownId = dropdown.id;
            var isOpen = getDropdownState(dropdownId);
            if (isOpen) {
              dropdown.classList.remove("hidden");
            } else {
              dropdown.classList.add("hidden");
            }
          });
        }

        document.addEventListener("DOMContentLoaded", function () {
          initializeDropdownStates();
        });
      </script>
    </ul>
  </nav>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const menuButtonOpen = document.getElementById("menu-button-open");
      const menuButtonClose = document.getElementById("menu-button-close");
      const sidebar = document.getElementById("application-sidebar");

      // Toggle sidebar for open button
      menuButtonOpen.addEventListener("click", function () {
        sidebar.classList.remove("-translate-x-full");
        sidebar.classList.add("translate-x-0");
      });

      // Toggle sidebar for close button
      menuButtonClose.addEventListener("click", function () {
        sidebar.classList.add("-translate-x-full");
        sidebar.classList.remove("translate-x-0");
      });
    });
  </script>
</div>
